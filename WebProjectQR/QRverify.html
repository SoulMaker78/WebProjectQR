<html>

<head>
  <title>QRCHECK</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript">
    function SetSrc() {
      let validHosts = ["gosuslugi.ru", "www.gosuslugi.ru"]
      let validPathPrefix = "/covid-cert/"
      let textBox = document.getElementById("txtSRC")
      let qrText = textBox.value
      textBox.value = ""

			try {
      	var url = new URL(qrText)
      } catch(error) {
      	var url = {}
      }

      if (validHosts.includes(url.hostname) && url.pathname.startsWith(validPathPrefix)) {
        document.getElementById("myIframe").src = qrText;
      } else {
	  
	  document.getElementById("myIframe").src = "https://xn--80aesfpebagmfblc0a.xn--p1ai/news/20210719-1216.html";
        //alert(`Наебалого: ${qrText}`)
      }
    }
  </script>

  <script>
    function searchKeyPress(e) {
      // look for window.event in case event isn't passed in
      e = e || window.event;
      if (e.keyCode == 13) {
        document.getElementById('btnSearch').click();
        return false;
      }
      return true;
    }
  </script>
</head>

<body>
  <form>
    Ожидание ввода со сканера:
    <input type="text" autofocus id="txtSRC" onkeypress="return searchKeyPress(event);" />
    <input type="button" id="btnSearch" value="GO" onclick="SetSrc()" />

  </form>
  <iframe id="myIframe" src="" width=100% height=94%></iframe>
</body>

</html>
